<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đăng Ký Tài Khoản - Vì Cộng Đồng Khỏe Mạnh</title>
    <meta name="description" content="Đăng ký tài khoản để tham gia cộng đồng phòng chống tệ nạn xã hội, cùng đóng góp cho một xã hội khỏe mạnh.">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles-auth.css">
    <script src="../js/auth.js" defer></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --accent-color: #9b59b6;
            --text-color: #333;
            --light-bg: #f8f9fa;
            --dark-bg: #222;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--light-bg);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .auth-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
        }

        .auth-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.8;
            background: linear-gradient(135deg, rgba(52,152,219,0.9), rgba(46,204,113,0.9));
        }

        .auth-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .auth-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            display: flex;
            flex: 1;
            align-items: center;
        }

        .auth-box {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            width: 100%;
            display: flex;
            flex-direction: row;
        }

        .auth-image {
            flex: 1;
            background-image: url('https://images.unsplash.com/photo-1593113646773-028c64a8f1b8?q=80&w=2070');
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            min-height: 600px;
        }

        .auth-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(52,152,219,0.8), rgba(46,204,113,0.8));
            z-index: 1;
        }

        .auth-image-content {
            position: relative;
            z-index: 2;
            padding: 40px;
            color: white;
            text-align: center;
        }

        .auth-image-content h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .auth-image-content p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .auth-form {
            flex: 1;
            padding: 40px;
            display: flex;
            flex-direction: column;
        }

        .auth-form h3 {
            color: var(--primary-color);
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
        }

        .form-floating {
            margin-bottom: 20px;
        }

        .form-floating .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(52, 152, 219, 0.25);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            padding: 12px 25px;
            font-weight: 600;
            border-radius: 50px;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .auth-divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
            color: #777;
        }

        .auth-divider::before, .auth-divider::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid #ddd;
        }

        .auth-divider span {
            padding: 0 15px;
            font-size: 0.9rem;
        }

        .social-login {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .social-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            transition: all 0.3s ease;
        }

        .social-btn:hover {
            transform: translateY(-3px);
        }

        .social-btn.facebook {
            background-color: #1877F2;
        }

        .social-btn.google {
            background-color: #DB4437;
        }

        .auth-footer {
            text-align: center;
            margin-top: 30px;
            font-size: 0.9rem;
            color: #666;
        }

        .auth-footer a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .auth-footer a:hover {
            text-decoration: underline;
        }

        .auth-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            color: var(--primary-color);
            font-size: 2rem;
        }

        .auth-logo i {
            margin-right: 10px;
            animation: pulse 2s infinite;
        }

        .password-requirements {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.85rem;
        }

        .requirement {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .requirement i {
            margin-right: 8px;
            font-size: 0.8rem;
        }

        .requirement.valid {
            color: var(--secondary-color);
        }

        .requirement.invalid {
            color: #e74c3c;
        }

        .requirement i.fa-check-circle {
            color: var(--secondary-color);
        }

        .requirement i.fa-times-circle {
            color: #e74c3c;
        }

        .have-account {
            text-align: center;
            margin-top: 20px;
        }

        .floating-pulse {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            animation: float 8s infinite ease-in-out;
        }

        .pulse-1 {
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .pulse-2 {
            top: 40%;
            right: 15%;
            width: 60px;
            height: 60px;
            animation-delay: 2s;
        }

        .pulse-3 {
            bottom: 30%;
            left: 20%;
            width: 100px;
            height: 100px;
            animation-delay: 4s;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) scale(1);
            }
            50% {
                transform: translateY(-20px) scale(1.1);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }

        .alert {
            padding: 10px 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            display: none;
        }

        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        @media (max-width: 992px) {
            .auth-box {
                flex-direction: column;
            }
            
            .auth-image {
                min-height: 300px;
            }
        }

        .back-to-home {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 50px;
            padding: 8px 20px;
            display: flex;
            align-items: center;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .back-to-home:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateX(-5px);
        }

        .back-to-home i {
            margin-right: 10px;
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: var(--dark-bg);
            color: #f8f9fa;
        }

        body.dark-mode .auth-box {
            background: rgba(33, 37, 41, 0.95);
        }

        body.dark-mode .auth-form h3,
        body.dark-mode .auth-footer a {
            color: var(--secondary-color);
        }

        body.dark-mode .form-control,
        body.dark-mode .form-select {
            background-color: #333;
            border-color: #444;
            color: #fff;
        }

        body.dark-mode .form-floating label {
            color: #adb5bd;
        }

        body.dark-mode .password-requirements {
            background-color: #2c3034;
            color: #adb5bd;
        }
    </style>
</head>
<body>
    <div class="auth-container">
        <div class="auth-background"></div>
        <div class="auth-particles" id="particles-js"></div>
        
        <a href="index.html" class="back-to-home">
            <i class="fas fa-arrow-left"></i> Về trang chủ
        </a>

        <div class="floating-pulse pulse-1"></div>
        <div class="floating-pulse pulse-2"></div>
        <div class="floating-pulse pulse-3"></div>

        <div class="auth-wrapper">
            <div class="auth-box">
                <div class="auth-image">
                    <div class="auth-image-content">
                        <h2>Chung tay xây dựng cộng đồng khỏe mạnh</h2>
                        <p>Đăng ký tài khoản để cùng chúng tôi đẩy lùi tệ nạn xã hội, bảo vệ thế hệ trẻ và xây dựng một xã hội an toàn, phát triển bền vững.</p>
                        <div class="d-flex justify-content-center">
                            <div class="auth-logo">
                                <i class="fas fa-shield-heart"></i>
                                <span>Vì Cộng Đồng Khỏe Mạnh</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="auth-form">
                    <h3>Đăng Ký Tài Khoản</h3>
                    
                    <div id="registerAlert" class="alert" role="alert" style="display: none;"></div>
                    
                    <form id="registerForm">
                        <div class="form-floating">
                            <input type="text" class="form-control" id="registerFullname" placeholder="Họ và tên" required>
                            <label for="registerFullname">Họ và tên</label>
                        </div>
                        
                        <div class="form-floating">
                            <input type="email" class="form-control" id="registerEmail" placeholder="Địa chỉ email" required>
                            <label for="registerEmail">Địa chỉ email</label>
                        </div>
                        
                        <div class="form-floating">
                            <input type="password" class="form-control" id="registerPassword" placeholder="Mật khẩu" required>
                            <label for="registerPassword">Mật khẩu</label>
                        </div>
                        
                        <div class="form-floating">
                            <input type="password" class="form-control" id="confirmPassword" placeholder="Xác nhận mật khẩu" required>
                            <label for="confirmPassword">Xác nhận mật khẩu</label>
                        </div>
                        
                        <div class="password-requirements">
                            <div class="requirement" id="length">
                                <i class="far fa-times-circle"></i>
                                <span>Ít nhất 8 ký tự</span>
                            </div>
                            <div class="requirement" id="uppercase">
                                <i class="far fa-times-circle"></i>
                                <span>Ít nhất 1 ký tự in hoa</span>
                            </div>
                            <div class="requirement" id="lowercase">
                                <i class="far fa-times-circle"></i>
                                <span>Ít nhất 1 ký tự thường</span>
                            </div>
                            <div class="requirement" id="number">
                                <i class="far fa-times-circle"></i>
                                <span>Ít nhất 1 số</span>
                            </div>
                            <div class="requirement" id="match">
                                <i class="far fa-times-circle"></i>
                                <span>Mật khẩu trùng khớp</span>
                            </div>
                        </div>
                        
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="agreeTerms" required>
                            <label class="form-check-label" for="agreeTerms">
                                Tôi đồng ý với <a href="terms-of-service.html">điều khoản sử dụng</a> và <a href="privacy-policy.html">chính sách bảo mật</a>
                            </label>
                        </div>
                        
                        <button type="submit" class="btn btn-primary w-100 py-3">
                            <i class="fas fa-user-plus me-2"></i>Đăng Ký
                        </button>
                    </form>
                    
                    <div class="auth-divider">
                        <span>hoặc đăng ký với</span>
                    </div>
                    
                    <div class="social-login">
                        <a href="#" class="social-btn facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="social-btn google">
                            <i class="fab fa-google"></i>
                        </a>
                    </div>
                    
                    <div class="have-account">
                        Đã có tài khoản? <a href="login.html">Đăng nhập</a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="auth-footer">
            <p>© 2023 Vì Cộng Đồng Khỏe Mạnh. Phát triển vì một tương lai không tệ nạn xã hội.</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Hiệu ứng particles
            if (typeof particlesJS !== 'undefined') {
                particlesJS('particles-js', {
                    particles: {
                        number: { value: 80, density: { enable: true, value_area: 800 } },
                        color: { value: "#ffffff" },
                        shape: { type: "circle" },
                        opacity: { value: 0.5, random: true },
                        size: { value: 3, random: true },
                        line_linked: { enable: true, distance: 150, color: "#ffffff", opacity: 0.2, width: 1 },
                        move: { enable: true, speed: 1, direction: "none", random: true, straight: false, out_mode: "out" }
                    },
                    interactivity: {
                        detect_on: "canvas",
                        events: { onhover: { enable: true, mode: "bubble" }, onclick: { enable: true, mode: "repulse" } }
                    }
                });
            }

            // Kiểm tra yêu cầu mật khẩu
            const passwordInput = document.getElementById('registerPassword');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const requirements = {
                length: document.getElementById('length'),
                uppercase: document.getElementById('uppercase'),
                lowercase: document.getElementById('lowercase'),
                number: document.getElementById('number'),
                match: document.getElementById('match')
            };

            function updateRequirements() {
                const password = passwordInput.value;
                const confirmPassword = confirmPasswordInput.value;
                
                // Length check
                if (password.length >= 8) {
                    requirements.length.classList.add('valid');
                    requirements.length.classList.remove('invalid');
                    requirements.length.querySelector('i').className = 'far fa-check-circle';
                } else {
                    requirements.length.classList.remove('valid');
                    requirements.length.classList.add('invalid');
                    requirements.length.querySelector('i').className = 'far fa-times-circle';
                }
                
                // Uppercase check
                if (/[A-Z]/.test(password)) {
                    requirements.uppercase.classList.add('valid');
                    requirements.uppercase.classList.remove('invalid');
                    requirements.uppercase.querySelector('i').className = 'far fa-check-circle';
                } else {
                    requirements.uppercase.classList.remove('valid');
                    requirements.uppercase.classList.add('invalid');
                    requirements.uppercase.querySelector('i').className = 'far fa-times-circle';
                }
                
                // Lowercase check
                if (/[a-z]/.test(password)) {
                    requirements.lowercase.classList.add('valid');
                    requirements.lowercase.classList.remove('invalid');
                    requirements.lowercase.querySelector('i').className = 'far fa-check-circle';
                } else {
                    requirements.lowercase.classList.remove('valid');
                    requirements.lowercase.classList.add('invalid');
                    requirements.lowercase.querySelector('i').className = 'far fa-times-circle';
                }
                
                // Number check
                if (/[0-9]/.test(password)) {
                    requirements.number.classList.add('valid');
                    requirements.number.classList.remove('invalid');
                    requirements.number.querySelector('i').className = 'far fa-check-circle';
                } else {
                    requirements.number.classList.remove('valid');
                    requirements.number.classList.add('invalid');
                    requirements.number.querySelector('i').className = 'far fa-times-circle';
                }
                
                // Password match check
                if (password === confirmPassword && password !== '') {
                    requirements.match.classList.add('valid');
                    requirements.match.classList.remove('invalid');
                    requirements.match.querySelector('i').className = 'far fa-check-circle';
                } else {
                    requirements.match.classList.remove('valid');
                    requirements.match.classList.add('invalid');
                    requirements.match.querySelector('i').className = 'far fa-times-circle';
                }
            }

            passwordInput.addEventListener('input', updateRequirements);
            confirmPasswordInput.addEventListener('input', updateRequirements);

            // Xử lý đăng ký
            const registerForm = document.getElementById('registerForm');
            const alertMessage = document.getElementById('registerAlert');
            
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const fullName = document.getElementById('registerFullname').value;
                const email = document.getElementById('registerEmail').value;
                const password = document.getElementById('registerPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                const agreeTerms = document.getElementById('agreeTerms').checked;
                
                // Kiểm tra các điều kiện
                if (!fullName || !email || !password || !confirmPassword) {
                    showAlert('Vui lòng điền đầy đủ thông tin', 'danger');
                    return;
                }
                
                if (password !== confirmPassword) {
                    showAlert('Mật khẩu xác nhận không khớp', 'danger');
                    return;
                }
                
                if (password.length < 8 || !/[A-Z]/.test(password) || !/[a-z]/.test(password) || !/[0-9]/.test(password)) {
                    showAlert('Mật khẩu không đáp ứng yêu cầu bảo mật', 'danger');
                    return;
                }
                
                if (!agreeTerms) {
                    showAlert('Vui lòng đồng ý với điều khoản sử dụng', 'danger');
                    return;
                }
                
                // Gửi dữ liệu đăng ký
                registerUser(fullName, email, password);
            });
            
            function showAlert(message, type) {
                alertMessage.textContent = message;
                alertMessage.className = `alert alert-${type}`;
                alertMessage.style.display = 'block';
                
                // Tự động ẩn thông báo sau 5 giây
                setTimeout(function() {
                    alertMessage.style.display = 'none';
                }, 5000);
            }
            
            function registerUser(fullName, email, password) {
                // Gửi request đến server
                fetch('/api/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        fullName: fullName,
                        email: email,
                        password: password
                    })
                })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(data => {
                            throw new Error(data.message || 'Đã xảy ra lỗi khi đăng ký');
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    showAlert('Đăng ký thành công! Bạn sẽ được chuyển hướng đến trang đăng nhập...', 'success');
                    
                    // Lưu thông tin đăng ký vào localStorage để hiển thị sau khi chuyển trang
                    localStorage.setItem('registerSuccess', 'true');
                    localStorage.setItem('registerEmail', email);
                    
                    // Chuyển hướng sau 2 giây
                    setTimeout(function() {
                        window.location.href = 'login.html';
                    }, 2000);
                })
                .catch(error => {
                    console.error('Error:', error);
                    showAlert(error.message, 'danger');
                });
            }
        });
    </script>
</body>
</html> 